
schemaVersion: 2.2.0
metadata:
  name: kai
components:
  - name: kai
    container:
      image: quay.io/juangonz/kai-devspaces:latest
      mountSources: true
      volumeMounts:
        - name: maven-repo-pvc # Nombre del volumen, que se vinculará al PVC
          path: /home/user/.m2 # Ruta estándar para el repositorio Maven
      env:
        - name: MAVEN_OPTS
          value: "-Dmaven.repo.local=/home/user/.m2/repository"
volumes:
  - name: maven-repo-pvc # Este nombre DEBE coincidir con el name en volumeMounts
    persistentVolumeClaim:
      spec:
        accessModes:
          - ReadWriteOnce # Típicamente suficiente para un repositorio Maven en un solo espacio de trabajo
        resources:
          requests:
            storage: 15Gi # Solicita 15 GB de almacenamiento para el repositorio Maven
        # storageClassName: premium-storage # Descomenta y ajusta si necesitas una StorageClass específica
commands:
   - id: maven-build
     exec:
       component: tools
       workingDir: ${PROJECT_SOURCE}
       commandLine: mvn clean install -DskipTests
       group:
         kind: build
         isDefault: true

